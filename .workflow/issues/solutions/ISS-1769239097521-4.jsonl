{"id":"SOL-ISS-1769239097521-4-a3n8","description":"Adopt C# 12 primary constructors to reduce boilerplate and improve readability","approach":"Convert SystemMetricProvider and other provider classes to use C# 12 primary constructor syntax. This eliminates explicit field declarations and assignment boilerplate while maintaining the same functionality. The project already targets .NET 8 which supports C# 12 features.","analysis":{"risk":"low","impact":"low","complexity":"low"},"score":0.85,"tasks":[{"id":"T1","title":"Convert SystemMetricProvider to primary constructor","scope":"XhMonitor.Core/Providers","action":"Update","description":"Refactor SystemMetricProvider to use C# 12 primary constructor syntax","modification_points":["XhMonitor.Core/Providers/SystemMetricProvider.cs"],"implementation":["Change class declaration to: public class SystemMetricProvider(IMetricProvider? cpuProvider, IMetricProvider? gpuProvider, IMetricProvider? memoryProvider, IMetricProvider? vramProvider, ILogger<SystemMetricProvider>? logger = null, bool initializeDxgi = true) : ISystemMetricProvider, IDisposable","Remove explicit field declarations for _cpuProvider, _gpuProvider, _memoryProvider, _vramProvider, _logger (lines 16-20)","Remove constructor body assignments (lines 35-39)","Keep DXGI initialization logic in constructor body","Access parameters directly as fields (cpuProvider, gpuProvider, etc.)","Update all references from _cpuProvider to cpuProvider throughout class"],"test":{"unit":["Test SystemMetricProvider instantiation with primary constructor","Test all methods access parameters correctly","Test constructor initialization logic still executes","Test Dispose method works correctly"],"commands":["dotnet test XhMonitor.Tests --filter SystemMetricProviderTests"]},"acceptance":{"criteria":["Class uses primary constructor syntax","Explicit field declarations removed","Constructor assignment boilerplate removed","All method references updated to use parameters","DXGI initialization logic preserved","All existing tests pass","No behavioral changes"],"verification":["Code compiles without errors","Run unit tests and confirm 100% pass rate","Verify no functional regressions"]},"commit":{"type":"refactor","scope":"providers","message_template":"refactor(providers): adopt C# 12 primary constructor in SystemMetricProvider\n\nReduce boilerplate with primary constructor syntax.\nMaintains same functionality with cleaner code."},"depends_on":[],"priority":1},{"id":"T2","title":"Convert CpuMetricProvider to primary constructor","scope":"XhMonitor.Core/Providers","action":"Update","description":"Refactor CpuMetricProvider to use C# 12 primary constructor if applicable","modification_points":["XhMonitor.Core/Providers/CpuMetricProvider.cs"],"implementation":["Review CpuMetricProvider constructor","If constructor has dependency injection parameters, convert to primary constructor","Remove explicit field declarations and assignments","Update all field references to parameter names","Preserve any initialization logic in constructor body"],"test":{"unit":["Test CpuMetricProvider instantiation","Test CollectAsync works correctly","Test WarmupAsync works correctly"],"commands":["dotnet test XhMonitor.Tests --filter CpuMetricProviderTests"]},"acceptance":{"criteria":["Primary constructor applied if applicable","Boilerplate reduced","All tests pass","No behavioral changes"],"verification":["Code compiles without errors","Run unit tests and confirm 100% pass rate"]},"commit":{"type":"refactor","scope":"providers","message_template":"refactor(providers): adopt C# 12 primary constructor in CpuMetricProvider"},"depends_on":[],"priority":2},{"id":"T3","title":"Convert GpuMetricProvider to primary constructor","scope":"XhMonitor.Core/Providers","action":"Update","description":"Refactor GpuMetricProvider to use C# 12 primary constructor if applicable","modification_points":["XhMonitor.Core/Providers/GpuMetricProvider.cs"],"implementation":["Review GpuMetricProvider constructor","If constructor has dependency injection parameters, convert to primary constructor","Remove explicit field declarations and assignments for injected dependencies","Update all field references to parameter names","Preserve initialization logic and non-injected fields"],"test":{"unit":["Test GpuMetricProvider instantiation","Test CollectAsync works correctly","Test WarmupAsync works correctly","Test DXGI integration works"],"commands":["dotnet test XhMonitor.Tests --filter GpuMetricProviderTests"]},"acceptance":{"criteria":["Primary constructor applied if applicable","Boilerplate reduced","All tests pass","No behavioral changes"],"verification":["Code compiles without errors","Run unit tests and confirm 100% pass rate"]},"commit":{"type":"refactor","scope":"providers","message_template":"refactor(providers): adopt C# 12 primary constructor in GpuMetricProvider"},"depends_on":[],"priority":2},{"id":"T4","title":"Convert VramMetricProvider to primary constructor","scope":"XhMonitor.Core/Providers","action":"Update","description":"Refactor VramMetricProvider to use C# 12 primary constructor if applicable","modification_points":["XhMonitor.Core/Providers/VramMetricProvider.cs"],"implementation":["Review VramMetricProvider constructor","If constructor has dependency injection parameters, convert to primary constructor","Remove explicit field declarations and assignments for injected dependencies","Update all field references to parameter names","Preserve initialization logic and non-injected fields"],"test":{"unit":["Test VramMetricProvider instantiation","Test CollectAsync works correctly","Test GetSystemTotalAsync works correctly"],"commands":["dotnet test XhMonitor.Tests --filter VramMetricProviderTests"]},"acceptance":{"criteria":["Primary constructor applied if applicable","Boilerplate reduced","All tests pass","No behavioral changes"],"verification":["Code compiles without errors","Run unit tests and confirm 100% pass rate"]},"commit":{"type":"refactor","scope":"providers","message_template":"refactor(providers): adopt C# 12 primary constructor in VramMetricProvider"},"depends_on":[],"priority":2},{"id":"T5","title":"Update project documentation","scope":"Documentation","action":"Update","description":"Document C# 12 primary constructor adoption in project guidelines","modification_points":[".mcai/docs/专有概念/MetricProvider.md","README.md"],"implementation":["Add note about C# 12 primary constructor usage in provider classes","Update code examples to show primary constructor syntax","Add to coding standards: prefer primary constructors for DI classes","Document benefits: reduced boilerplate, improved readability"],"test":{"unit":[],"commands":[]},"acceptance":{"criteria":["Documentation updated with primary constructor examples","Coding standards include primary constructor preference","Benefits documented"],"verification":["Review documentation for accuracy","Verify examples compile"]},"commit":{"type":"docs","scope":"providers","message_template":"docs(providers): document C# 12 primary constructor adoption\n\nUpdate examples and coding standards."},"depends_on":["T1","T2","T3","T4"],"priority":3}],"is_bound":true,"bound_at":"2026-01-24T07:40:01.075Z"}
