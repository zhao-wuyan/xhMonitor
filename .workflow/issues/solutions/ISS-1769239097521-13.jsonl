{"id":"SOL-ISS-1769239097521-13-p3x8","description":"Replace hardcoded service path with configuration-based approach","approach":"Current implementation uses hardcoded relative paths ('../../../..') which couples the application to development directory structure and fails in production/deployment. Solution: Create appsettings.json configuration file with ServiceExecutablePath setting, add configuration loading in App.xaml.cs, and update BackendServerService to use configured path with fallback to relative path for development.","analysis":{"risk":"low","impact":"high","complexity":"low"},"score":0.95,"tasks":[{"id":"T1","title":"Create appsettings.json configuration file","scope":"XhMonitor.Desktop","action":"Create","description":"Add appsettings.json with ServiceExecutablePath configuration and ensure it's copied to output directory","modification_points":["XhMonitor.Desktop/appsettings.json (new file)","XhMonitor.Desktop/XhMonitor.Desktop.csproj (update to copy config)"],"implementation":["Create appsettings.json with structure: {\"ServiceExecutablePath\": \"../Service/XhMonitor.Service.exe\"}","Add <ItemGroup> entry in .csproj to copy appsettings.json to output: <None Update=\"appsettings.json\"><CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory></None>"],"test":{"unit":[],"commands":["dotnet build XhMonitor.Desktop/XhMonitor.Desktop.csproj"]},"acceptance":{"criteria":["appsettings.json file created with ServiceExecutablePath setting","Configuration file copied to output directory on build","Default path supports both development and published scenarios"],"verification":["Build succeeds","appsettings.json exists in bin/Debug/net8.0-windows/ after build"]},"commit":{"type":"feat","scope":"desktop","message_template":"feat(desktop): add configuration file for service executable path"},"depends_on":[],"priority":1},{"id":"T2","title":"Add configuration loading to App.xaml.cs","scope":"XhMonitor.Desktop/App.xaml.cs","action":"Update","description":"Add Microsoft.Extensions.Configuration to load appsettings.json and register IConfiguration in DI container","modification_points":["App.xaml.cs OnStartup method (lines 20-59)","Add using Microsoft.Extensions.Configuration"],"implementation":["Add using Microsoft.Extensions.Configuration and Microsoft.Extensions.Configuration.Json","In OnStartup before ServiceCollection creation, build configuration: var configuration = new ConfigurationBuilder().SetBasePath(AppDomain.CurrentDomain.BaseDirectory).AddJsonFile(\"appsettings.json\", optional: true).Build()","Register configuration as singleton: services.AddSingleton<IConfiguration>(configuration)"],"test":{"unit":[],"commands":["dotnet build XhMonitor.Desktop/XhMonitor.Desktop.csproj"]},"acceptance":{"criteria":["IConfiguration registered in DI container","Configuration loads from appsettings.json","Configuration available to all services"],"verification":["Build succeeds without errors","No runtime exceptions during startup"]},"commit":{"type":"feat","scope":"desktop","message_template":"feat(desktop): load configuration from appsettings.json"},"depends_on":["T1"],"priority":2},{"id":"T3","title":"Update BackendServerService to use configuration","scope":"XhMonitor.Desktop/Services/BackendServerService.cs","action":"Update","description":"Inject IConfiguration and use configured path with fallback to relative path for backward compatibility","modification_points":["BackendServerService constructor (lines 16-19)","StartAsync method path resolution (lines 28-53)"],"implementation":["Add IConfiguration parameter to constructor","Store configuration in private readonly field","In StartAsync, read path from configuration: var configuredPath = _configuration[\"ServiceExecutablePath\"]","Use configured path if present, otherwise fallback to current relative path logic","Update both published version check (line 29) and development path (line 43) to use configured path"],"test":{"unit":[],"commands":["dotnet build XhMonitor.Desktop/XhMonitor.Desktop.csproj"]},"acceptance":{"criteria":["BackendServerService uses configured path when available","Fallback to relative path maintains backward compatibility","Both development and published scenarios work correctly"],"verification":["Build succeeds","Service starts correctly in development mode","Service detection works in published mode"]},"commit":{"type":"refactor","scope":"desktop/services","message_template":"refactor(desktop/services): use configuration for service executable path"},"depends_on":["T2"],"priority":3},{"id":"T4","title":"Add package reference for Configuration","scope":"XhMonitor.Desktop/XhMonitor.Desktop.csproj","action":"Update","description":"Add Microsoft.Extensions.Configuration.Json package reference if not already present","modification_points":["XhMonitor.Desktop.csproj ItemGroup with PackageReferences"],"implementation":["Check if Microsoft.Extensions.Configuration.Json is already referenced","If not present, add: <PackageReference Include=\"Microsoft.Extensions.Configuration.Json\" Version=\"8.*\" />"],"test":{"unit":[],"commands":["dotnet restore XhMonitor.Desktop/XhMonitor.Desktop.csproj","dotnet build XhMonitor.Desktop/XhMonitor.Desktop.csproj"]},"acceptance":{"criteria":["Microsoft.Extensions.Configuration.Json package referenced","Package version compatible with net8.0","Restore and build succeed"],"verification":["dotnet restore succeeds","dotnet build succeeds","No package version conflicts"]},"commit":{"type":"chore","scope":"desktop","message_template":"chore(desktop): add Configuration.Json package reference"},"depends_on":[],"priority":1}],"is_bound":true,"bound_at":"2026-01-24T07:39:39.771Z"}
