{"id":"SOL-ISS-1769239097521-23-b2k4","description":"Extract process management into IProcessManager interface following existing service patterns","approach":"Create IProcessManager interface following the same pattern as IBackendServerService and IWebServerService. Implement ProcessManager that encapsulates Process lifecycle management (start, stop, kill). Update App.xaml.cs OnProcessActionRequested to use IProcessManager instead of direct Process.GetProcessById. This maintains consistency with existing service abstractions and enables testability.","analysis":{"risk":"low","impact":"low","complexity":"low"},"score":0.85,"tasks":[{"id":"T1","title":"Create IProcessManager interface","scope":"XhMonitor.Desktop/Services","action":"Create","description":"Define IProcessManager interface for process lifecycle operations","modification_points":["XhMonitor.Desktop/Services/IProcessManager.cs"],"implementation":["Create IProcessManager interface with KillProcess(int processId, bool entireTree) method","Add TryGetProcessById(int processId, out Process? process) method for safe process retrieval","Follow existing service interface patterns (IBackendServerService, IWebServerService)"],"test":{"unit":[],"commands":[]},"acceptance":{"criteria":["IProcessManager interface created with 2 methods","Interface follows existing service patterns","Method signatures match Process API semantics"],"verification":["File exists at XhMonitor.Desktop/Services/IProcessManager.cs","Interface compiles without errors","Method signatures reviewed for correctness"]},"commit":{"type":"feat","scope":"desktop/services","message_template":"feat(desktop/services): add IProcessManager interface\n\nDefine interface for process lifecycle management following existing service patterns."},"depends_on":[],"priority":1},{"id":"T2","title":"Implement ProcessManager service","scope":"XhMonitor.Desktop/Services","action":"Create","description":"Implement ProcessManager with error handling for process operations","modification_points":["XhMonitor.Desktop/Services/ProcessManager.cs"],"implementation":["Create ProcessManager class implementing IProcessManager","Implement KillProcess with try-catch for UnauthorizedAccessException, InvalidOperationException, ArgumentException","Implement TryGetProcessById with safe process retrieval","Return Result<bool, string> or similar to communicate success/failure with error messages","Use Process.GetProcessById and Process.Kill(entireProcessTree) internally"],"test":{"unit":["Test KillProcess succeeds for valid process","Test KillProcess handles UnauthorizedAccessException","Test KillProcess handles InvalidOperationException (process already exited)","Test KillProcess handles ArgumentException (invalid PID)","Test TryGetProcessById returns true for valid process","Test TryGetProcessById returns false for invalid process"],"commands":["dotnet test XhMonitor.Desktop.Tests --filter ProcessManagerTests"]},"acceptance":{"criteria":["ProcessManager implements IProcessManager","All exception types handled with specific error messages","Unit tests achieve 100% code coverage","Error messages are user-friendly"],"verification":["Run unit tests and verify all pass","Code review confirms all exception paths handled","Error messages reviewed for clarity"]},"commit":{"type":"feat","scope":"desktop/services","message_template":"feat(desktop/services): implement ProcessManager service\n\nAdd ProcessManager with safe process lifecycle operations and comprehensive error handling."},"depends_on":["T1"],"priority":2},{"id":"T3","title":"Register ProcessManager in DI container","scope":"XhMonitor.Desktop","action":"Update","description":"Register IProcessManager in App.xaml.cs service collection","modification_points":["XhMonitor.Desktop/App.xaml.cs"],"implementation":["Add services.AddSingleton<IProcessManager, ProcessManager>() in OnStartup","Add private field _processManager in App class","Initialize _processManager from service provider: _processManager = _serviceProvider.GetRequiredService<IProcessManager>()"],"test":{"unit":[],"commands":[]},"acceptance":{"criteria":["IProcessManager registered in DI container","_processManager field added to App class","Service resolved successfully on startup"],"verification":["Application starts without DI resolution errors","_processManager is not null after initialization","Debug output confirms service registration"]},"commit":{"type":"feat","scope":"desktop/di","message_template":"feat(desktop/di): register ProcessManager in DI container\n\nAdd IProcessManager to service collection for dependency injection."},"depends_on":["T2"],"priority":3},{"id":"T4","title":"Refactor OnProcessActionRequested to use IProcessManager","scope":"XhMonitor.Desktop","action":"Update","description":"Replace direct Process API calls with IProcessManager in OnProcessActionRequested","modification_points":["XhMonitor.Desktop/App.xaml.cs"],"implementation":["Replace Process.GetProcessById call with _processManager.KillProcess","Remove try-catch block (error handling now in ProcessManager)","Update toast messages based on ProcessManager return value","Simplify logic: if (e.Action == \"kill\") { var result = _processManager.KillProcess(e.ProcessId, true); if (!result.Success) _floatingWindow?.ShowToast(result.ErrorMessage); }"],"test":{"unit":[],"commands":[]},"acceptance":{"criteria":["No direct Process.GetProcessById calls in OnProcessActionRequested","Error handling delegated to ProcessManager","Toast messages show appropriate errors","Code is simpler and more readable"],"verification":["Search for 'Process.GetProcessById' in App.xaml.cs (should find 0 in OnProcessActionRequested)","Test kill process action in running application","Verify error messages display correctly for unauthorized/invalid processes"]},"commit":{"type":"refactor","scope":"desktop","message_template":"refactor(desktop): use IProcessManager in OnProcessActionRequested\n\nReplace direct Process API calls with IProcessManager abstraction for better testability."},"depends_on":["T3"],"priority":4}],"is_bound":true,"bound_at":"2026-01-24T07:40:06.611Z"}
