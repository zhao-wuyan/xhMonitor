<Window x:Class="XhMonitor.Desktop.Windows.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="XhMonitor 设置" Height="600" Width="800"
        WindowStartupLocation="CenterScreen" ResizeMode="NoResize"
        Background="#1E1E1E" Foreground="#E0E0E0">

    <Window.Resources>
        <!-- 颜色资源 -->
        <SolidColorBrush x:Key="WindowBackground" Color="#1E1E1E"/>
        <SolidColorBrush x:Key="WindowForeground" Color="#E0E0E0"/>
        <SolidColorBrush x:Key="ButtonBackground" Color="#333333"/>
        <SolidColorBrush x:Key="ButtonHover" Color="#444444"/>
        <SolidColorBrush x:Key="NavBackground" Color="#252526"/>
        <SolidColorBrush x:Key="NavBorder" Color="#3F3F46"/>
        <SolidColorBrush x:Key="NavItemHover" Color="#2D2D30"/>
        <SolidColorBrush x:Key="NavItemSelected" Color="#252526"/>
        <SolidColorBrush x:Key="AccentBlue" Color="#007ACC"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#AAAAAA"/>
        <SolidColorBrush x:Key="TextPrimary" Color="White"/>
        <SolidColorBrush x:Key="InputBackground" Color="#333333"/>
        <SolidColorBrush x:Key="ListBackground" Color="#2D2D30"/>
        <SolidColorBrush x:Key="SeparatorColor" Color="#3F3F46"/>
        <SolidColorBrush x:Key="CardBackground" Color="#272727"/>
        <SolidColorBrush x:Key="CardBorder" Color="#333333"/>
        <SolidColorBrush x:Key="ToggleTrackOff" Color="#3A3A3A"/>
        <SolidColorBrush x:Key="ToggleThumb" Color="#F2F2F2"/>

        <!-- 图标 Path 资源 -->
        <PathGeometry x:Key="IconPalette" Figures="M12 2C11.5 2 11 2.19 10.59 2.59L2.59 10.59C1.8 11.37 1.8 12.63 2.59 13.41L10.59 21.41C11.37 22.2 12.63 22.2 13.41 21.41L21.41 13.41C22.2 12.63 22.2 11.37 21.41 10.59L13.41 2.59C13 2.19 12.5 2 12 2M12 4L20 12L12 20L4 12M7 12C7 14.76 9.24 17 12 17S17 14.76 17 12H7Z"/>
        <PathGeometry x:Key="IconChart" Figures="M3 3V21H21V19H5V3H3M9 17H11V10H9V17M13 17H15V7H13V17M17 17H19V13H17V17Z"/>
        <PathGeometry x:Key="IconSettings" Figures="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5A3.5 3.5 0 0 1 15.5 12A3.5 3.5 0 0 1 12 15.5M19.43 12.97C19.47 12.65 19.5 12.33 19.5 12C19.5 11.67 19.47 11.34 19.43 11L21.54 9.37C21.73 9.22 21.78 8.95 21.66 8.73L19.66 5.27C19.54 5.05 19.27 4.96 19.05 5.05L16.56 6.05C16.04 5.66 15.5 5.32 14.87 5.07L14.5 2.42C14.46 2.18 14.25 2 14 2H10C9.75 2 9.54 2.18 9.5 2.42L9.13 5.07C8.5 5.32 7.96 5.66 7.44 6.05L4.95 5.05C4.73 4.96 4.46 5.05 4.34 5.27L2.34 8.73C2.21 8.95 2.27 9.22 2.46 9.37L4.57 11C4.53 11.34 4.5 11.67 4.5 12C4.5 12.33 4.53 12.65 4.57 12.97L2.46 14.63C2.27 14.78 2.21 15.05 2.34 15.27L4.34 18.73C4.46 18.95 4.73 19.03 4.95 18.95L7.44 17.94C7.96 18.34 8.5 18.68 9.13 18.93L9.5 21.58C9.54 21.82 9.75 22 10 22H14C14.25 22 14.46 21.82 14.5 21.58L14.87 18.93C15.5 18.67 16.04 18.34 16.56 17.94L19.05 18.95C19.27 19.03 19.54 18.95 19.66 18.73L21.66 15.27C21.78 15.05 21.73 14.78 21.54 14.63L19.43 12.97Z"/>
        <PathGeometry x:Key="IconInfo" Figures="M13 9H11V7H13M13 17H11V11H13M12 2A10 10 0 0 0 2 12A10 10 0 0 0 12 22A10 10 0 0 0 22 12A10 10 0 0 0 12 2Z"/>
        <PathGeometry x:Key="IconShield" Figures="M12 2L4 5V11C4 16.5 7.8 21.4 12 22C16.2 21.4 20 16.5 20 11V5L12 2Z"/>

        <!-- ScrollBar 暗色主题样式 -->
        <Style x:Key="DarkScrollBar" TargetType="ScrollBar">
            <Setter Property="Background" Value="{StaticResource ListBackground}"/>
            <Setter Property="Foreground" Value="#555555"/>
            <Setter Property="Width" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid>
                            <Border Background="{TemplateBinding Background}" CornerRadius="6"/>
                            <Track x:Name="PART_Track" IsDirectionReversed="True">
                                <Track.Thumb>
                                    <Thumb>
                                        <Thumb.Template>
                                            <ControlTemplate>
                                                <Border Background="{TemplateBinding Foreground}" CornerRadius="6" Margin="2"/>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ScrollViewer 暗色主题样式 -->
        <Style TargetType="ScrollViewer">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <ScrollContentPresenter Grid.Column="0" Grid.Row="0"/>
                            <ScrollBar x:Name="PART_VerticalScrollBar"
                                     Grid.Column="1" Grid.Row="0"
                                     Style="{StaticResource DarkScrollBar}"
                                     Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                     Value="{TemplateBinding VerticalOffset}"
                                     Maximum="{TemplateBinding ScrollableHeight}"
                                     ViewportSize="{TemplateBinding ViewportHeight}"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ComboBox 暗色主题样式 -->
        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="{StaticResource InputBackground}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{StaticResource NavBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                        ClickMode="Press">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="ToggleButton">
                                        <Border Background="{TemplateBinding Background}"
                                              BorderBrush="{TemplateBinding BorderBrush}"
                                              BorderThickness="{TemplateBinding BorderThickness}"
                                              CornerRadius="4">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="20"/>
                                                </Grid.ColumnDefinitions>
                                                <ContentPresenter Grid.Column="0" Margin="5,0,0,0" VerticalAlignment="Center"/>
                                                <Path Grid.Column="1" Fill="{StaticResource TextSecondary}"
                                                    Data="M 0 0 L 4 4 L 8 0 Z"
                                                    HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                            <ContentPresenter x:Name="ContentSite"
                                            IsHitTestVisible="False"
                                            Content="{TemplateBinding SelectionBoxItem}"
                                            ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                            Margin="5,3,25,3"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Left"/>
                            <Popup x:Name="Popup"
                                 Placement="Bottom"
                                 IsOpen="{TemplateBinding IsDropDownOpen}"
                                 AllowsTransparency="True"
                                 Focusable="False"
                                 PopupAnimation="Slide">
                                <Grid MinWidth="{TemplateBinding ActualWidth}"
                                    MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border Background="{StaticResource ListBackground}"
                                          BorderBrush="{StaticResource NavBorder}"
                                          BorderThickness="1"
                                          CornerRadius="4">
                                        <ScrollViewer>
                                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ComboBoxItem 暗色主题样式 -->
        <Style TargetType="ComboBoxItem">
            <Setter Property="Foreground" Value="{StaticResource WindowForeground}"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="Border" Background="Transparent" Padding="{TemplateBinding Padding}">
                            <ContentPresenter/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource NavItemHover}"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource NavItemSelected}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 现代化按钮样式 -->
        <Style TargetType="Button">
            <Setter Property="Background" Value="{StaticResource ButtonBackground}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="15,12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource ButtonHover}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{StaticResource InputBackground}"/>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter Property="BorderBrush" Value="{StaticResource AccentBlue}"/>
                                <Setter Property="BorderThickness" Value="1"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 导航列表项样式 -->
        <Style TargetType="ListBoxItem">
            <Setter Property="Padding" Value="20,15"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondary}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Border x:Name="Border" Background="Transparent" BorderThickness="4,0,0,0" BorderBrush="Transparent">
                            <ContentPresenter Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource NavItemSelected}"/>
                                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource AccentBlue}"/>
                                <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource NavItemHover}"/>
                                <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource AccentBlue}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Settings 卡片样式 -->
        <Style x:Key="SettingsCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBackground}"/>
            <Setter Property="BorderBrush" Value="{StaticResource CardBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <!-- Settings Tile 样式（用于开关网格） -->
        <Style x:Key="SettingsTile" TargetType="Border">
            <Setter Property="Background" Value="#1F1F1F"/>
            <Setter Property="BorderBrush" Value="{StaticResource NavBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12"/>
            <Setter Property="Margin" Value="6"/>
        </Style>

        <!-- Settings 单行输入框样式（修复文本垂直偏上问题） -->
        <Style x:Key="SettingsSingleLineTextBox" TargetType="TextBox">
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Background" Value="{StaticResource InputBackground}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{StaticResource NavBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10,0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="InputBorder"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8"
                                SnapsToDevicePixels="True">
                            <Grid Margin="{TemplateBinding Padding}">
                                <ScrollViewer x:Name="PART_ContentHost"
                                              HorizontalAlignment="Stretch"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="InputBorder" Property="BorderBrush" Value="#5A5A5A"/>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="InputBorder" Property="BorderBrush" Value="{StaticResource AccentBlue}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="InputBorder" Property="Opacity" Value="0.55"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ToggleSwitch 样式 -->
        <Style x:Key="ToggleSwitchStyle" TargetType="CheckBox">
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid VerticalAlignment="Center">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ContentPresenter Grid.Column="0"
                                              VerticalAlignment="Center"
                                              RecognizesAccessKey="True"
                                              Margin="0,0,12,0"/>
                            <Border x:Name="SwitchTrack"
                                    Grid.Column="1"
                                    Width="46"
                                    Height="24"
                                    Background="{StaticResource ToggleTrackOff}"
                                    CornerRadius="12">
                                <Border x:Name="SwitchThumb"
                                        Width="20"
                                        Height="20"
                                        Background="{StaticResource ToggleThumb}"
                                        CornerRadius="10"
                                        HorizontalAlignment="Left"
                                        Margin="2"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="SwitchTrack" Property="Background" Value="{StaticResource AccentBlue}"/>
                                <Setter TargetName="SwitchThumb" Property="HorizontalAlignment" Value="Right"/>
                                <Setter TargetName="SwitchThumb" Property="Background" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="SwitchTrack" Property="Background" Value="#4A4A4A"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsChecked" Value="True"/>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="SwitchTrack" Property="Background" Value="#1A8CD6"/>
                            </MultiTrigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="SwitchTrack" Property="Opacity" Value="0.5"/>
                                <Setter TargetName="SwitchThumb" Property="Opacity" Value="0.5"/>
                                <Setter Property="Foreground" Value="{StaticResource TextSecondary}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- 左侧导航栏 -->
        <Border Background="{StaticResource NavBackground}" BorderBrush="{StaticResource NavBorder}" BorderThickness="0,0,1,0">
            <StackPanel>
                <TextBlock Text="设置" FontSize="24" FontWeight="Bold" Margin="20,30,20,30" Foreground="{StaticResource TextPrimary}"/>
                <ListBox x:Name="NavList" Background="Transparent" BorderThickness="0" SelectedIndex="0">
                    <ListBoxItem Tag="System">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Path Grid.Column="0" Data="{StaticResource IconSettings}"
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"
                                  Stretch="Uniform" Width="14" Height="14" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1" Text="系统选项" Margin="8,0,0,0" VerticalAlignment="Center"/>
                        </Grid>
                    </ListBoxItem>
                    <ListBoxItem Tag="Appearance">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Path Grid.Column="0" Data="{StaticResource IconPalette}"
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"
                                  Stretch="Uniform" Width="14" Height="14" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1" Text="外观设置" Margin="8,0,0,0" VerticalAlignment="Center"/>
                        </Grid>
                    </ListBoxItem>
                    <ListBoxItem Tag="Data">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Path Grid.Column="0" Data="{StaticResource IconChart}"
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"
                                  Stretch="Uniform" Width="14" Height="14" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1" Text="数据采集" Margin="8,0,0,0" VerticalAlignment="Center"/>
                        </Grid>
                    </ListBoxItem>
                    <ListBoxItem Tag="About">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Path Grid.Column="0" Data="{StaticResource IconInfo}"
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"
                                  Stretch="Uniform" Width="14" Height="14" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1" Text="关于" Margin="8,0,0,0" VerticalAlignment="Center"/>
                        </Grid>
                    </ListBoxItem>
                </ListBox>
            </StackPanel>
        </Border>

        <!-- 右侧内容区 -->
        <Grid Grid.Column="1" Margin="30">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- 分页内容 -->
            <TabControl x:Name="ContentTabControl"
                        Grid.Row="0"
                        Background="Transparent"
                        BorderThickness="0"
                        SelectedIndex="{Binding ElementName=NavList, Path=SelectedIndex}">

                <!-- 页面 1: 系统选项 -->
                <TabItem Visibility="Collapsed">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock Text="系统选项" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20" Foreground="White"/>

                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Border Width="28"
                                                Height="28"
                                                CornerRadius="6"
                                                Background="#1F1F1F"
                                                BorderBrush="{StaticResource NavBorder}"
                                                BorderThickness="1"
                                                Margin="0,0,12,0">
                                            <Viewbox Width="14" Height="14">
                                                <Path Data="{StaticResource IconSettings}" Fill="{StaticResource TextSecondary}"/>
                                            </Viewbox>
                                        </Border>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="开机自启动" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                            <TextBlock Text="随系统启动自动运行" FontSize="12" Foreground="{StaticResource TextSecondary}"/>
                                        </StackPanel>
                                        <CheckBox Grid.Column="2"
                                                  Style="{StaticResource ToggleSwitchStyle}"
                                                  IsChecked="{Binding StartWithWindows}"
                                                  VerticalAlignment="Center"/>
                                    </Grid>

                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Border Width="28"
                                                Height="28"
                                                CornerRadius="6"
                                                Background="#1F1F1F"
                                                BorderBrush="{StaticResource NavBorder}"
                                                BorderThickness="1"
                                                Margin="0,0,12,0">
                                            <Viewbox Width="14" Height="14">
                                                <Path Data="{StaticResource IconShield}" Fill="{StaticResource AccentBlue}"/>
                                            </Viewbox>
                                        </Border>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="管理员模式" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                            <TextBlock Text="允许采集需要管理员权限的指标" FontSize="12" Foreground="{StaticResource TextSecondary}"/>
                                        </StackPanel>
                                        <CheckBox Grid.Column="2"
                                                  Style="{StaticResource ToggleSwitchStyle}"
                                                  IsChecked="{Binding AdminMode}"
                                                  VerticalAlignment="Center"/>
                                    </Grid>

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Border Width="28"
                                                Height="28"
                                                CornerRadius="6"
                                                Background="#1F1F1F"
                                                BorderBrush="{StaticResource NavBorder}"
                                                BorderThickness="1"
                                                Margin="0,0,12,0">
                                            <Viewbox Width="14" Height="14">
                                                <Path Data="M12 2L4 5V11C4 16.5 7.8 21.4 12 22C16.2 21.4 20 16.5 20 11V5L12 2M12 12L16 8L14.6 6.6L12 9.2L9.4 6.6L8 8L12 12Z" Fill="#FF9800"/>
                                            </Viewbox>
                                        </Border>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="启用局域网访问" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                            <TextBlock Text="允许局域网内其他设备访问Web界面（需重启生效）" FontSize="12" Foreground="{StaticResource TextSecondary}"/>
                                        </StackPanel>
                                        <CheckBox Grid.Column="2"
                                                  Style="{StaticResource ToggleSwitchStyle}"
                                                  IsChecked="{Binding EnableLanAccess}"
                                                  VerticalAlignment="Center"/>
                                    </Grid>

                                    <!-- 本机IP地址显示 -->
                                    <Border Margin="40,12,0,12"
                                            Padding="10,6"
                                            CornerRadius="4"
                                            Background="#1E2A1E"
                                            HorizontalAlignment="Left"
                                            MaxWidth="520">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0"
                                                       Text="本机IP: "
                                                       FontSize="12"
                                                       Foreground="{StaticResource TextSecondary}"
                                                       VerticalAlignment="Center"/>
                                            <TextBlock Grid.Column="1"
                                                       Text="{Binding LocalIpEndpoint}"
                                                       FontSize="12"
                                                       Foreground="#81C784"
                                                       FontWeight="SemiBold"
                                                       VerticalAlignment="Center"
                                                       TextWrapping="Wrap"/>
                                        </Grid>
                                    </Border>

                                    <!-- Service 管理员状态指示器 -->
                                    <Border Margin="40,12,0,0"
                                            Padding="10,6"
                                            CornerRadius="4"
                                            HorizontalAlignment="Left">
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Background" Value="#2D2D30"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ServiceIsAdmin}" Value="True">
                                                        <Setter Property="Background" Value="#1E3A1E"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding ServiceIsAdmin}" Value="False">
                                                        <Setter Property="Background" Value="#3A2A1E"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <StackPanel Orientation="Horizontal">
                                            <Ellipse Width="8" Height="8" Margin="0,0,8,0" VerticalAlignment="Center">
                                                <Ellipse.Style>
                                                    <Style TargetType="Ellipse">
                                                        <Setter Property="Fill" Value="#888888"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding ServiceIsAdmin}" Value="True">
                                                                <Setter Property="Fill" Value="#4CAF50"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding ServiceIsAdmin}" Value="False">
                                                                <Setter Property="Fill" Value="#FF9800"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Ellipse.Style>
                                            </Ellipse>
                                            <TextBlock FontSize="12" VerticalAlignment="Center">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="{StaticResource TextSecondary}"/>
                                                        <Setter Property="Text" Value="Service 状态未知"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding ServiceIsAdmin}" Value="True">
                                                                <Setter Property="Text" Value="Service 已获得管理员权限"/>
                                                                <Setter Property="Foreground" Value="#81C784"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding ServiceIsAdmin}" Value="False">
                                                                <Setter Property="Text" Value="Service 未以管理员权限运行"/>
                                                                <Setter Property="Foreground" Value="#FFB74D"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Border>

                            <!-- 局域网安全设置卡片 -->
                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="局域网安全设置" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}" Margin="0,0,0,12"/>

                                    <!-- 访问密钥开关 -->
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Border Width="28"
                                                Height="28"
                                                CornerRadius="6"
                                                Background="#1F1F1F"
                                                BorderBrush="{StaticResource NavBorder}"
                                                BorderThickness="1"
                                                Margin="0,0,12,0">
                                            <Viewbox Width="14" Height="14">
                                                <Path Data="M12 1L3 5V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V5L12 1M12 7C13.4 7 14.8 8.1 14.8 9.5V11C15.4 11 16 11.6 16 12.3V15.8C16 16.4 15.4 17 14.7 17H9.2C8.6 17 8 16.4 8 15.7V12.2C8 11.6 8.6 11 9.2 11V9.5C9.2 8.1 10.6 7 12 7M12 8.2C11.2 8.2 10.5 8.7 10.5 9.5V11H13.5V9.5C13.5 8.7 12.8 8.2 12 8.2Z" Fill="#4CAF50"/>
                                            </Viewbox>
                                        </Border>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="启用访问密钥" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                            <TextBlock Text="要求局域网访问时提供密钥（增强安全性）" FontSize="12" Foreground="{StaticResource TextSecondary}"/>
                                        </StackPanel>
                                        <CheckBox Grid.Column="2"
                                                  Style="{StaticResource ToggleSwitchStyle}"
                                                  IsChecked="{Binding EnableAccessKey}"
                                                  VerticalAlignment="Center"/>
                                    </Grid>

                                    <!-- 访问密钥输入 -->
                                    <StackPanel Margin="40,0,0,12">
                                        <TextBlock Text="访问密钥" Foreground="{StaticResource TextSecondary}" FontSize="12" Margin="0,0,0,5"/>
                                        <TextBox Style="{StaticResource SettingsSingleLineTextBox}"
                                                 Text="{Binding AccessKey, UpdateSourceTrigger=PropertyChanged}"
                                                 Height="30"
                                                 IsEnabled="{Binding EnableAccessKey}"
                                                 FontFamily="Consolas"
                                                 FontSize="12"/>
                                        <TextBlock Text="留空将自动生成随机密钥" FontSize="11" Foreground="{StaticResource TextSecondary}" Margin="0,4,0,0"/>
                                    </StackPanel>

                                    <!-- IP白名单 -->
                                    <StackPanel Margin="0,0,0,0">
                                        <TextBlock Text="IP白名单（可选）" Foreground="{StaticResource TextSecondary}" FontSize="12" Margin="0,0,0,5"/>
                                        <TextBox Text="{Binding IpWhitelist, UpdateSourceTrigger=PropertyChanged}"
                                                 Height="80"
                                                 AcceptsReturn="True"
                                                 TextWrapping="Wrap"
                                                 VerticalScrollBarVisibility="Auto"
                                                 VerticalContentAlignment="Top"
                                                 Padding="8"
                                                 Background="{StaticResource InputBackground}"
                                                 Foreground="{StaticResource TextPrimary}"
                                                 BorderBrush="{StaticResource NavBorder}"
                                                 BorderThickness="1"
                                                 FontFamily="Consolas"
                                                 FontSize="12"/>
                                        <TextBlock TextWrapping="Wrap" FontSize="11" Foreground="{StaticResource TextSecondary}" Margin="0,4,0,0">
                                            每行一个IP地址或CIDR段，例如：<LineBreak/>
                                            192.168.1.100<LineBreak/>
                                            192.168.1.0/24<LineBreak/>
                                            留空表示不限制IP访问
                                        </TextBlock>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

                <!-- 页面 2: 外观设置 -->
                <TabItem Visibility="Collapsed">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock Text="外观设置" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20" Foreground="{StaticResource TextPrimary}"/>

                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="悬浮窗透明度" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,5"/>
                                    <Grid Margin="0,0,0,4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <Slider Maximum="100" Minimum="20" Value="{Binding Opacity}" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="{Binding Opacity, StringFormat={}{0}%}" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="显示模式" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}" Margin="0,0,0,4"/>
                                    <TextBlock Text="悬浮窗与迷你/贴边模式可单独开启；当两者同时开启时，默认先显示悬浮窗，可通过拖动吸附切换到迷你/贴边模式。迷你/贴边模式支持“柱状条/文本紧凑”两种风格，默认柱状条，单位使用最短形式（如 G/M、K/s）。"
                                               Foreground="{StaticResource TextSecondary}" FontSize="12" Margin="0,0,0,12" TextWrapping="Wrap"/>

                                    <UniformGrid Rows="1" Columns="2" Margin="0,0,0,12">
                                        <Border Style="{StaticResource SettingsTile}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <TextBlock Text="悬浮窗模式" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                                    <TextBlock Text="Desktop Floating Window" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                                                </StackPanel>
                                                <CheckBox Grid.Column="1" Style="{StaticResource ToggleSwitchStyle}" IsChecked="{Binding EnableFloatingMode}" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                        <Border Style="{StaticResource SettingsTile}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <TextBlock Text="迷你/贴边模式" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                                    <TextBlock Text="Organic Dock（拖动吸附）" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                                                </StackPanel>
                                                <CheckBox Grid.Column="1" Style="{StaticResource ToggleSwitchStyle}" IsChecked="{Binding EnableEdgeDockMode}" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </UniformGrid>

                                    <TextBlock Text="迷你/贴边风格" Foreground="{StaticResource TextSecondary}" FontSize="12" Margin="0,0,0,8"/>
                                    <ComboBox Height="32"
                                              Margin="0,0,0,12"
                                              SelectedValuePath="Tag"
                                              SelectedValue="{Binding DockVisualStyle, UpdateSourceTrigger=PropertyChanged}">
                                        <ComboBoxItem Content="柱状条（默认）" Tag="Bar"/>
                                        <ComboBoxItem Content="文本紧凑" Tag="Text"/>
                                    </ComboBox>

                                    <TextBlock Text="迷你/贴边指标名称（可自定义，默认单字母）" Foreground="{StaticResource TextSecondary}" FontSize="12" Margin="0,0,0,8"/>
                                    <UniformGrid Rows="2" Columns="4" Margin="0,0,0,10">
                                        <StackPanel Margin="0,0,8,8">
                                            <TextBlock Text="CPU 名称" FontSize="11" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,4"/>
                                            <TextBox Style="{StaticResource SettingsSingleLineTextBox}" Height="30" Text="{Binding DockCpuLabel, UpdateSourceTrigger=PropertyChanged}"/>
                                        </StackPanel>
                                        <StackPanel Margin="0,0,8,8">
                                            <TextBlock Text="内存名称" FontSize="11" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,4"/>
                                            <TextBox Style="{StaticResource SettingsSingleLineTextBox}" Height="30" Text="{Binding DockMemoryLabel, UpdateSourceTrigger=PropertyChanged}"/>
                                        </StackPanel>
                                        <StackPanel Margin="0,0,8,8">
                                            <TextBlock Text="GPU 名称" FontSize="11" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,4"/>
                                            <TextBox Style="{StaticResource SettingsSingleLineTextBox}" Height="30" Text="{Binding DockGpuLabel, UpdateSourceTrigger=PropertyChanged}"/>
                                        </StackPanel>
                                        <StackPanel Margin="0,0,0,8">
                                            <TextBlock Text="VRAM 名称" FontSize="11" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,4"/>
                                            <TextBox Style="{StaticResource SettingsSingleLineTextBox}" Height="30" Text="{Binding DockVramLabel, UpdateSourceTrigger=PropertyChanged}"/>
                                        </StackPanel>
                                        <StackPanel Margin="0,0,0,8">
                                            <TextBlock Text="功耗名称" FontSize="11" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,4"/>
                                            <TextBox Style="{StaticResource SettingsSingleLineTextBox}" Height="30" Text="{Binding DockPowerLabel, UpdateSourceTrigger=PropertyChanged}"/>
                                        </StackPanel>
                                        <StackPanel Margin="0,0,8,0">
                                            <TextBlock Text="上传前缀" FontSize="11" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,4"/>
                                            <TextBox Style="{StaticResource SettingsSingleLineTextBox}" Height="30" Text="{Binding DockUploadLabel, UpdateSourceTrigger=PropertyChanged}"/>
                                        </StackPanel>
                                        <StackPanel Margin="0,0,8,0">
                                            <TextBlock Text="下载前缀" FontSize="11" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,4"/>
                                            <TextBox Style="{StaticResource SettingsSingleLineTextBox}" Height="30" Text="{Binding DockDownloadLabel, UpdateSourceTrigger=PropertyChanged}"/>
                                        </StackPanel>
                                        <StackPanel Margin="0,0,8,0">
                                            <TextBlock Text="组间距(px，0=自动)" FontSize="11" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,4"/>
                                            <TextBox Style="{StaticResource SettingsSingleLineTextBox}" Height="30" Text="{Binding DockColumnGap, UpdateSourceTrigger=PropertyChanged}"/>
                                        </StackPanel>
                                    </UniformGrid>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

                <!-- 页面 3: 数据采集 -->
                <TabItem Visibility="Collapsed">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock Text="数据采集" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20" Foreground="White"/>

                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="监控配置" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}" Margin="0,0,0,4"/>
                                    <TextBlock Text="选择需要采集的指标，开启后将在主界面展示。"
                                               Foreground="{StaticResource TextSecondary}" FontSize="12" Margin="0,0,0,12"/>
                                    <UniformGrid Rows="2" Columns="3">
                                        <Border Style="{StaticResource SettingsTile}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <TextBlock Text="CPU" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                                    <TextBlock Text="处理器" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                                                </StackPanel>
                                                <CheckBox Grid.Column="1" Style="{StaticResource ToggleSwitchStyle}" IsChecked="{Binding MonitorCpu}" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                        <Border Style="{StaticResource SettingsTile}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <TextBlock Text="Memory" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                                    <TextBlock Text="内存" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                                                </StackPanel>
                                                <CheckBox Grid.Column="1" Style="{StaticResource ToggleSwitchStyle}" IsChecked="{Binding MonitorMemory}" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                        <Border Style="{StaticResource SettingsTile}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <TextBlock Text="GPU" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                                    <TextBlock Text="显卡" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                                                </StackPanel>
                                                <CheckBox Grid.Column="1" Style="{StaticResource ToggleSwitchStyle}" IsChecked="{Binding MonitorGpu}" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                        <Border Style="{StaticResource SettingsTile}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <TextBlock Text="VRAM" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                                    <TextBlock Text="显存" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                                                </StackPanel>
                                                <CheckBox Grid.Column="1" Style="{StaticResource ToggleSwitchStyle}" IsChecked="{Binding MonitorVram}" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                        <Border Style="{StaticResource SettingsTile}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <TextBlock Text="Power" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                                    <TextBlock Text="功耗" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                                                </StackPanel>
                                                <CheckBox Grid.Column="1" Style="{StaticResource ToggleSwitchStyle}" IsChecked="{Binding MonitorPower}" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                        <Border Style="{StaticResource SettingsTile}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <TextBlock Text="Network" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}"/>
                                                    <TextBlock Text="网络" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                                                </StackPanel>
                                                <CheckBox Grid.Column="1" Style="{StaticResource ToggleSwitchStyle}" IsChecked="{Binding MonitorNetwork}" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </UniformGrid>
                                </StackPanel>
                            </Border>

                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="进程监控关键词" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}" Margin="0,0,0,4"/>
                                    <TextBlock Text="每行一个关键词。支持正则表达式，使用 ! 前缀排除，例如：!chrome"
                                               Foreground="{StaticResource TextSecondary}" FontSize="12" Margin="0,0,0,12" TextWrapping="Wrap"/>
                                    <TextBox Text="{Binding ProcessKeywords, UpdateSourceTrigger=PropertyChanged}"
                                             Height="150"
                                             AcceptsReturn="True"
                                             TextWrapping="Wrap"
                                             VerticalScrollBarVisibility="Auto"
                                             Background="{StaticResource ListBackground}"
                                             Foreground="{StaticResource TextPrimary}"
                                             BorderBrush="{StaticResource NavBorder}"
                                             BorderThickness="1"
                                             Padding="8"
                                             FontFamily="Consolas"
                                             FontSize="12"/>
                                </StackPanel>
                            </Border>

                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="采集策略" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}" Margin="0,0,0,4"/>
                                    <TextBlock Text="Top 进程数量" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,5"/>
                                    <TextBox Style="{StaticResource SettingsSingleLineTextBox}"
                                             Height="35"
                                             Text="{Binding TopProcessCount}"
                                             Margin="0,0,0,16"/>

                                    <TextBlock Text="历史数据保留时长 (天)" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,5"/>
                                    <TextBox Style="{StaticResource SettingsSingleLineTextBox}"
                                             Height="35"
                                             Text="{Binding DataRetentionDays}"
                                             />
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

                <!-- 页面 4: 关于 -->
                <TabItem Visibility="Collapsed">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock Text="关于" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20" Foreground="White"/>

                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="XhMonitor" FontSize="16" FontWeight="Bold" Foreground="White" Margin="0,0,0,6"/>
                                    <TextBlock x:Name="SettingsAboutVersionTextBlock" Text="版本：" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,2"/>
                                    <TextBlock x:Name="SettingsAboutWebUrlTextBlock" Text="Web：" Foreground="{StaticResource TextSecondary}" Margin="0,0,0,10"/>
                                    <TextBlock Text="高性能 Windows 进程资源监控与可视化工具，支持实时采集、聚合分析与 Web 可视化。" Foreground="{StaticResource TextSecondary}" TextWrapping="Wrap"/>

                                    <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                                        <Button Content="打开 Web 界面" Width="120" Height="34" Background="{StaticResource AccentBlue}" Click="OpenWebUi_Click"/>
                                        <Button Content="复制信息" Width="100" Height="34" Margin="10,0,0,0" Click="CopyAboutInfo_Click"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="主要能力" FontSize="14" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,10"/>
                                    <TextBlock Foreground="{StaticResource TextSecondary}" TextWrapping="Wrap">
                                        • 实时监控进程 CPU、内存、GPU、显存等资源占用<LineBreak/>
                                        • SignalR 实时推送 + Web 可视化面板（Glassmorphism）<LineBreak/>
                                        • 分层聚合存储：原始 / 分钟 / 小时 / 天（便于回放与分析）<LineBreak/>
                                        • 桌面悬浮窗与桌面小组件模式
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="技术栈" FontSize="14" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,10"/>
                                    <TextBlock Foreground="{StaticResource TextSecondary}" TextWrapping="Wrap">
                                        • 桌面端：WPF + MVVM（.NET 8）<LineBreak/>
                                        • 后端：.NET 8 + ASP.NET Core + SignalR<LineBreak/>
                                        • 数据：SQLite + EF Core 8<LineBreak/>
                                        • Web：React 19 + TypeScript + Vite 7 + TailwindCSS v4<LineBreak/>
                                        • 可视化：ECharts 6<LineBreak/>
                                        • 采集：LibreHardwareMonitor + Windows Performance Counter API<LineBreak/>
                                        • 日志：Serilog
                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
            </TabControl>

            <!-- 底部操作栏 -->
            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                <Button Content="恢复默认" Height="36" Margin="0,0,10,0" Background="Transparent" Foreground="{StaticResource TextSecondary}" Click="RestoreDefaults_Click"/>
                <Button Content="关 闭" Width="100" Height="36" Margin="0,0,10,0" Click="Cancel_Click"/>
                <Button x:Name="SaveButton" Content="保 存" Width="100" Height="36" Background="{StaticResource AccentBlue}" Click="Save_Click"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
